var $=Object.defineProperty;var ee=(e,o,r)=>o in e?$(e,o,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[o]=r;var L=(e,o,r)=>ee(e,typeof o!="symbol"?o+"":o,r);import"./modulepreload-polyfill-B5Qt9EMX.js";/* empty css                    */import{K as oe,J as te,S as ne,a as B,l as ae,m as re,Q as le,n as ie,o as O,d as Y,M as S,X as se,Y as de,c as ce,b as me,T as we,p as ue,q as he,Z as ge,G as f,P as fe,e as pe,D as xe,f as E}from"./GLTFLoader-wlXMjBjz.js";import{P as ye,C as j,T as ve,a as z,S as M,i as q}from"./tiles-DzyDbYKX.js";class Se extends ye{constructor(r){super();L(this,"isCarMode",!0);L(this,"bounds",null);const s=new oe(12);if(this.add(s),r)for(var w=0;w<r.children.length;w++)r.children[w].position.setScalar(0,0,0),this.add(r.children[w])}}var C;let H=!1,A=!1;var h;let be=0;var c=null;const n={controller:null,originals:new j,box:new te},D=new j;function P(e){e.receiveShadow=!0,e.castShadow=!0,e.traverse(o=>{o.isMesh&&(o.castShadow=!0,o.receiveShadow=!0)})}async function ke(){const e=new ne;e.background=new B().setHSL(.5,1,.7);const o=document.getElementById("threedee1"),r=o.getBoundingClientRect().height;h=new ae(75,window.innerWidth/r,.1,2e3),h.position.fromArray([0,21.22465751184184,40.4622033919508]),window.cam=h;const s=new re({antialias:!0});s.setSize(window.innerWidth,o.getBoundingClientRect().height),o.appendChild(s.domElement),s.shadowMap.enabled=!0,s.shadowMap.type=le,C=new ie(h,s.domElement);const w=new O(1,1,1),b=new Y({color:65280});new S(w,b);const J=new se(4329984,6086399,12);new de(J,100);const K=document.getElementById("vertexShader").textContent,Q=document.getElementById("fragmentShader").textContent,X={topColor:{value:new B(11392511)},bottomColor:{value:new B(15465727)},offset:{value:-1.1},exponent:{value:.4}},Z=new ce(1e3,32,15),N=new me({uniforms:X,vertexShader:K,fragmentShader:Q,side:we}),U=new S(Z,N);e.add(U);const G=new ue;G.intensity=1.81,e.add(G);const a=new he;a.castShadow=!0,a.position.copy({x:-4.2,y:6,z:12.2}),a.intensity=2.7,a.color.setHex(16777215),e.add(a),a.shadow.mapSize.width=512*1,a.shadow.mapSize.height=512*1,a.shadow.camera.near=.5,a.shadow.camera.far=200,a.shadow.bias=1e-5,a.shadow.bias=1e-6,a.shadow.radius=.001,a.position.multiplyScalar(5);var p=48;a.shadow.camera.top=p,a.shadow.camera.bottom=-p,a.shadow.camera.left=p,a.shadow.camera.right=-p,new ge(a.shadow.camera),window.addEventListener("resize",_);function _(){h.aspect=window.innerWidth/r,h.updateProjectionMatrix(),s.setSize(window.innerWidth,r)}function x({item:t,volumeW:i=1,volumeH:l=1,volumeD:y=1}){const u=new O(i,l,y),v=new Y({wireframe:!0,color:11176174});let m=new S(u,v);m.position.set(0,0,0),m.geometry.computeBoundingBox(),console.log(m.geometry.boundingBox),t.volume=m,t.add(m)}{var d=await new f().loadAsync("../models/tacocar/tacocar1.glb");let t=d.scene;c=new Se(t),c.position.set(2,4,10),e.add(c),P(c),x({item:c,volumeW:7,volumeH:6,volumeD:4})}{var d=await new f().loadAsync("../models/tacocar/streetplate3.glb");let i=d.scene;n.originals.add(i),n.controller=new ve,e.add(n.controller),n.controller.position.z=20,D.add(n.controller),n.controller.position.set(0,-10,12);let l=new z({item:n.originals[0].clone(),paddingLeft:2.4,paddingRight:-1.2,showDebugger:!0});n.controller.addHorizontal(l),l.name="111",l.position.x+=-40;let y=new M({color:16776960,radius:6});l.add(y),y.position.y=22,x({item:l,volumeW:50,volumeH:24,volumeD:10});let u=new z({item:n.originals[0].clone(),paddingLeft:2.4,paddingRight:-1.2,showDebugger:!0});n.controller.addHorizontal(u),u.name="222",u.position.x+=40;let v=new M({color:61166,radius:6});u.add(v),v.position.y=22,x({item:u,volumeW:50,volumeH:24,volumeD:10});let m=new z({item:n.originals[0].clone(),paddingLeft:2.4,paddingRight:-1.2,showDebugger:!0});n.controller.addHorizontal(m),m.name="222",m.position.x+=80;let I=new M({color:16772846,radius:6});m.add(I),I.position.y=22,x({item:m,volumeW:50,volumeH:24,volumeD:10}),n.controller.snapAllInOrder();for(var k=0;k<n.controller.horizontal.length;k++)n.controller.horizontal[k].cachePosition()}{const t=new fe(1,1),i=new pe({color:65280,side:xe}),l=new S(t,i);l.scale.setScalar(144),l.rotation.x=Math.PI/2,l.position.z=-60,e.add(l),l.receiveShadow=!0}{var d=await new f().loadAsync("../models/tacocar/sidewalk.glb");let i=d.scene;e.add(d.scene),P(i)}{var d=await new f().loadAsync("../models/tacocar/tree1.glb");let i=d.scene;e.add(d.scene),P(i)}{var d=await new f().loadAsync("../models/tacocar/building1.glb");d.scene,e.add(d.scene)}document.addEventListener("wheel",t=>{be+=t.deltaY}),document.addEventListener("keydown",t=>{t.key==="z"&&(console.log("z"),n.controller.snapFrontToBack(!0)),t.key==="x"&&(console.log("z"),n.controller.snapBackToFront(!0)),(t.key==="ArrowLeft"||t.key==="a")&&(H=!0),(t.key==="ArrowRight"||t.key==="d")&&(A=!0)}),document.addEventListener("keyup",t=>{(t.key==="ArrowLeft"||t.key==="a")&&(H=!1),(t.key==="ArrowRight"||t.key==="d")&&(A=!1)}),new E;function F(){requestAnimationFrame(F),C!==void 0&&C.update();let t=.9;H&&c&&(c.position.x+=-t),A&&c&&(c.position.x+=t);for(var i=0;i<D.length;i++)D[i].entities.run();Le(),s.render(e,h)}F()}let W=new E,R=new E,g=null,T=null,V=!1;function Le(){g=null;const e=n.controller.horizontal;c.getWorldPosition(R);for(var o=0;o<e.length;o++){e[o],e[o].getWorldPosition(W);let r=W.x+e[o].volume.geometry.boundingBox.min.x,s=W.x+e[o].volume.geometry.boundingBox.max.x,w=R.x+c.volume.geometry.boundingBox.min.x,b=R.x+c.volume.geometry.boundingBox.max.x;q(w,r,s)&&q(b,r,s)&&(g=e[o]),g&&(V===!1&&(V=!0,T=g),T!==g&&(T=g,n.controller.snapBackToFront(!1)))}}ke();
