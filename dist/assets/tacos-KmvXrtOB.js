var U=Object.defineProperty;var X=(a,n,e)=>n in a?U(a,n,{enumerable:!0,configurable:!0,writable:!0,value:e}):a[n]=e;var s=(a,n,e)=>(X(a,typeof n!="symbol"?n+"":n,e),e);import{a as z,b as D,c as j,d as Z,V as p,e as V,f as Y,T as _,S as $,C as M,P as ee,W as te,g as ae,O as ne,B as oe,M as se,H as ie,h as re,i as le,j as de,A as he,D as ce,k as we,G as m,l as pe,m as ue}from"./GLTFLoader-bqpfs_I4.js";class g extends z{constructor(e={}){const{radius:t=1,res:i=12,color:h=65280,debug:w=!1}=e,S=new D(t,i,i),b=new j({color:h});super(S,b);s(this,"isSphereMesh",!0);s(this,"isPrimitive",!0);if(w){const k=new Z(1);this.add(k)}this.name="spherey"}}class R extends Array{constructor(){super(...arguments);s(this,"selectedIndex",0)}add(e){this.push(e)}swapFront(){return this.swap("front"),this}swapBack(){return this.swap("back"),this}swap(e){if(this.length<1){console.log("length must be greater than 1");return}if(e==="front"){const t=this.shift();this.push(t)}if(e==="back"){const t=this.pop();this.unshift(t)}}}const G=new p,me=new p,I=new p,ge=new p;new p;class fe extends Y{constructor(){super(...arguments);s(this,"vertical",new R);s(this,"horizontal",new R)}addHorizontal(e){this.horizontal.add(e),this.add(e)}snap(e,t,i,h){e.updateMatrix(),t.updateMatrix(),e[i].getWorldPosition(G),t.getWorldPosition(ge),t[h].getWorldPosition(me),I.copy(t[h].position),t.position.copy(t.parent.worldToLocal(G)).sub(I)}snapBackToFront(){const e=this.horizontal[this.horizontal.length-1],t=this.horizontal[0];this.snap(e,t,"east","west"),this.horizontal.swapFront(),console.log(this.horizontal[0].name,this.horizontal[1].name)}snapFrontToBack(){const e=this.horizontal[0],t=this.horizontal[this.horizontal.length-1];this.snap(e,t,"west","east"),this.horizontal.swapBack(),console.log(this.horizontal[0].name,this.horizontal[1].name)}snapAllInOrder(){for(var e=1;e<this.horizontal.length;e++)this.snap(this.horizontal[e-1],this.horizontal[e],"east","west")}}const O=new V,L=new p;class P extends Y{constructor({item:e,paddingLeft:t=0,paddingRight:i=0,showDebugger:h=!1}={}){super();s(this,"isTile",!0);s(this,"verticalPoints",[]);s(this,"horizontalPoints",[]);s(this,"west",null);s(this,"east",null);s(this,"north",null);s(this,"south",null);s(this,"up",null);s(this,"down",null);if(e.position.set(0,0,0),e.rotation.set(0,0,0),e.updateMatrix(),window.pw=this,e)for(var w=0;w<e.children.length;w++)this.add(e.children[w]);O.setFromObject(this),O.getSize(L),this.verticalPoints[0]=new g({color:255,radius:2}),this.verticalPoints[1]=new g({color:255,radius:2}),this.add(this.verticalPoints[0]),this.add(this.verticalPoints[1]),this.west=this.verticalPoints[0],this.east=this.verticalPoints[1],this.west.position.x=-L.x/2+t,this.east.position.x=L.x/2+i,this.west.visible=h,this.east.visible=h}}var C;let ve=0;var A=null,y=null;new V;var d=null;function B(a){a.receiveShadow=!0,a.castShadow=!0,a.traverse(n=>{n.isMesh&&(n.castShadow=!0,n.receiveShadow=!0)})}async function xe(){window.THREE=_;const a=new $;a.background=new M().setHSL(.5,1,.7);const n=document.getElementById("threedee1"),e=n.getBoundingClientRect().height,t=new ee(75,window.innerWidth/e,.1,2e3);t.position.fromArray([0,21.22465751184184,40.4622033919508]),t.lookAt(new p(0,0,0).fromArray([.00859148296684644,-.24372632714083164,-.9698059929072776]).multiplyScalar(1)),window.cam=t;const i=new te({antialias:!0});i.setSize(window.innerWidth,n.getBoundingClientRect().height),n.appendChild(i.domElement),i.shadowMap.enabled=!0,i.shadowMap.type=ae,C=new ne(t,i.domElement);const h=new oe(1,1,1),w=new se({color:65280});new z(h,w);const S=new ie(4329984,6086399,12);new re(S,100);const b=document.getElementById("vertexShader").textContent,k=document.getElementById("fragmentShader").textContent,q={topColor:{value:new M(11392511)},bottomColor:{value:new M(15465727)},offset:{value:-1.1},exponent:{value:.4}},J=new D(1e3,32,15),K=new le({uniforms:q,vertexShader:b,fragmentShader:k,side:de}),N=new z(J,K);a.add(N);const H=new he;H.intensity=1.81,a.add(H);const o=new ce;o.castShadow=!0,o.position.copy({x:-4.2,y:6,z:12.2}),o.intensity=2.7,o.color.setHex(16777215),a.add(o),o.shadow.mapSize.width=512*1,o.shadow.mapSize.height=512*1,o.shadow.camera.near=.5,o.shadow.camera.far=200,o.shadow.bias=1e-5,o.shadow.bias=1e-6,o.shadow.radius=.001,o.position.multiplyScalar(5);var f=48;o.shadow.camera.top=f,o.shadow.camera.bottom=-f,o.shadow.camera.left=f,o.shadow.camera.right=-f,new we(o.shadow.camera),window.addEventListener("resize",Q);function Q(){t.aspect=window.innerWidth/e,t.updateProjectionMatrix(),i.setSize(window.innerWidth,e)}{var r=await new m().loadAsync("../models/tacocar/tacocar1.glb");let c=r.scene;A=c,a.add(r.scene),B(c)}{var r=await new m().loadAsync("../models/tacocar/streetplate3.glb");y=r.scene,d=new fe,a.add(d),d.position.z=20,window.streetTiles1=d;let l=new P({item:y.clone(),paddingLeft:2.4,paddingRight:-1.2,showDebugger:!0});d.addHorizontal(l),l.name="111",l.position.x+=-40;let E=new g({color:16776960,radius:6});l.add(E),E.position.y=22;let v=new P({item:y.clone(),paddingLeft:2.4,paddingRight:-1.2,showDebugger:!0});d.addHorizontal(v),v.name="222",v.position.x+=40;let F=new g({color:61166,radius:6});v.add(F),F.position.y=22;let x=new P({item:y.clone(),paddingLeft:2.4,paddingRight:-1.2,showDebugger:!0});d.addHorizontal(x),x.name="222",x.position.x+=80;let W=new g({color:16772846,radius:6});x.add(W),W.position.y=22,d.snapAllInOrder()}{const c=new pe(1,1),u=new j({color:65280,side:ue}),l=new z(c,u);l.scale.setScalar(144),l.rotation.x=Math.PI/2,l.position.z=-60,a.add(l),l.receiveShadow=!0}{var r=await new m().loadAsync("../models/tacocar/sidewalk.glb");let u=r.scene;a.add(r.scene),B(u)}{var r=await new m().loadAsync("../models/tacocar/tree1.glb");let u=r.scene;a.add(r.scene),B(u)}{var r=await new m().loadAsync("../models/tacocar/building1.glb");r.scene,a.add(r.scene)}document.addEventListener("wheel",c=>{ve+=c.deltaY}),document.addEventListener("keydown",c=>{c.key==="z"&&(console.log("z"),d.snapFrontToBack()),c.key==="x"&&(console.log("z"),d.snapBackToFront())});function T(){requestAnimationFrame(T),C!==void 0&&C.update(),A&&(A.position.x+=.1),i.render(a,t)}T()}xe();
